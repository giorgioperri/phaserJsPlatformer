!function(e){function t(t){for(var i,n,h=t[0],l=t[1],o=t[2],d=0,p=[];d<h.length;d++)n=h[d],Object.prototype.hasOwnProperty.call(a,n)&&a[n]&&p.push(a[n][0]),a[n]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);for(c&&c(t);p.length;)p.shift()();return r.push.apply(r,o||[]),s()}function s(){for(var e,t=0;t<r.length;t++){for(var s=r[t],i=!0,h=1;h<s.length;h++){var l=s[h];0!==a[l]&&(i=!1)}i&&(r.splice(t--,1),e=n(n.s=s[0]))}return e}var i={},a={0:0},r=[];function n(t){if(i[t])return i[t].exports;var s=i[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=i,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(s,i,function(t){return e[t]}.bind(null,i));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="";var h=window.webpackJsonp=window.webpackJsonp||[],l=h.push.bind(h);h.push=t,h=h.slice();for(var o=0;o<h.length;o++)t(h[o]);var c=l;r.push([20,1]),s()}([,,,function(e,t,s){"use strict";var i=s(0),a=s.n(i);class r extends a.a.Scene{constructor(e,t){super(e),this.config=t}create(){this.add.image(0,0,"menuBg").setOrigin(0).setScale(3.8);const e=this.config.canGoBack?this.add.image(this.config.width-10,this.config.height-10,"back").setOrigin(1).setScale(2).setInteractive():null;e&&e.on("pointerup",(()=>{this.scene.start("MenuScene")}))}createMenu(e,t){let s=0;e.forEach((e=>{const i=[this.config.width/2,this.config.height/1.4+s];e.textGO=this.add.text(...i,e.text,{fontFamily:"NHU",fontSize:"10px",fill:"#ffffff"}).setStroke("#1d1d1b",6).setOrigin(.5,1),s+=50,t(e)}))}}t.a=r},,,,,,,,,,,,function(e,t,s){"use strict";(function(e){var i=s(0),a=s.n(i);class r extends a.a.Scene{constructor(){super("PreloadScene")}preload(){this.load.tilemapTiledJSON("level-1","assets/v2/lv_1.json"),this.load.tilemapTiledJSON("level-2","assets/v2/lv_2.json"),this.load.tilemapTiledJSON("level-3","assets/v2/lv_3.json"),this.load.tilemapTiledJSON("level-4","assets/v2/lv_4.json"),this.load.image("tiles-1","assets/v2/nhu_tileset.png"),this.load.image("logo","assets/v2/logo.png"),this.load.image("menuBg","assets/v2/bgMenu.png"),this.load.image("sky","assets/sky_play.png"),this.load.image("bg-spikes-dark","assets/bg_spikes_dark.png"),this.load.image("gameplay-bg-0","assets/v2/bg/bg_layer 1.png"),this.load.image("gameplay-bg-1","assets/v2/bg/bg_layer 2.png"),this.load.image("gameplay-bg-2","assets/v2/bg/bg_layer 3.png"),this.load.image("gameplay-bg-3","assets/v2/bg/bg_layer 4.png"),this.load.image("gameplay-bg-4","assets/v2/bg/bg_layer 5.png"),this.load.image("moveText","assets/v2/TEXTS/move.png"),this.load.image("jumpText","assets/v2/TEXTS/jump.png"),this.load.image("slashText","assets/v2/TEXTS/slash.png"),this.load.image("shootText","assets/v2/TEXTS/shoot.png"),this.load.image("doubleJumpText","assets/v2/TEXTS/doubleJump.png"),this.load.image("twiceText","assets/v2/TEXTS/twice.png"),this.load.image("menu-bg","assets/background01.png"),this.load.image("back","assets/back.png"),this.load.image("iceball-1","assets/weapons/iceball_001.png"),this.load.image("iceball-2","assets/weapons/iceball_002.png"),this.load.image("fireball-1","assets/weapons/improved_fireball_001.png"),this.load.image("fireball-2","assets/weapons/improved_fireball_002.png"),this.load.image("fireball-3","assets/weapons/improved_fireball_003.png"),this.load.image("key","assets/v2/nhu_key.png"),this.load.spritesheet("battery","assets/v2/battery.png",{frameWidth:13,frameHeight:24}),this.load.spritesheet("nhuIdle","assets/v2/Nhu_idle.png",{frameWidth:32,frameHeight:29}),this.load.spritesheet("nhuJump","assets/v2/Nhu_jump.png",{frameWidth:32,frameHeight:29}),this.load.spritesheet("nhuThrow","assets/v2/Nhu_attack_ranged.png",{frameWidth:32,frameHeight:29}),this.load.spritesheet("nhuWalk","assets/v2/Nhu_walk.png",{frameWidth:32,frameHeight:29}),this.load.spritesheet("greenProjectile","assets/v2/nhu_projectile.png",{frameWidth:16,frameHeight:16,spacing:4}),this.load.spritesheet("playerSlide","assets/player/slide_sheet_2.png",{frameWidth:32,frameHeight:38,spacing:32}),this.load.spritesheet("birdman","assets/v2/bad_guy_1_walk.png",{frameWidth:15,frameHeight:32}),this.load.spritesheet("gunner","assets/v2/bad_guy_2_walk.png",{frameWidth:24,frameHeight:25}),this.load.spritesheet("blaster","assets/v2/bad_guy_2_shoot.png",{frameWidth:57,frameHeight:25}),this.load.spritesheet("hitSheet","assets/weapons/hit_effect_sheet.png",{frameWidth:32,frameHeight:32}),this.load.spritesheet("swordDefault","assets/v2/Nhu_attack_close.png",{frameWidth:76,frameHeight:31}),this.load.audio("theme","assets/music/new/theme.mp3"),this.load.audio("projectile-launch","assets/music/new/projectile.wav"),this.load.audio("step","assets/music/new/step.wav"),this.load.audio("jump","assets/music/new/jump.wav"),this.load.audio("swipe","assets/music/new/swoosh.wav"),this.load.audio("collectiblePickup","assets/music/new/pickup.wav");const t=e.env.FB_ENV||!0;this.load.on("progress",(e=>{t&&FBInstant.setLoadingProgress(100*e)})),this.load.once("complete",(()=>{t?FBInstant.startGameAsync().then((()=>{this.startGame()})):this.startGame()}))}startGame(){this.registry.set("level",1),this.registry.set("unlocked-levels",1),this.scene.start("MenuScene")}}t.a=r}).call(this,s(7))},function(e,t,s){"use strict";var i=s(3);class a extends i.a{constructor(e){super("MenuScene",e),this.menu=[{scene:"PlayScene",text:"PLAY"},{scene:"LevelScene",text:"LEVELS"},{scene:null,text:"EXIT"}]}create(){super.create(),this.createMenu(this.menu,this.setupMenuEvents.bind(this)),this.add.image(this.config.width/2,this.config.height/3,"logo").setScale(.6)}setupMenuEvents(e){const t=e.textGO;t.setInteractive(),t.on("pointerover",(()=>{t.setStyle({fill:"#a1ffa5"})})),t.on("pointerout",(()=>{t.setStyle({fill:"#ffffff"})})),t.on("pointerup",(()=>{e.scene&&this.scene.start(e.scene),"Exit"===e.text&&this.game.destroy(!0)}))}}t.a=a},function(e,t,s){"use strict";var i=s(3);class a extends i.a{constructor(e){super("LevelScene",{...e,canGoBack:!0})}create(){super.create(),this.menu=[];const e=this.registry.get("unlocked-levels");for(let t=1;t<=e;t++)this.menu.push({scene:"PlayScene",text:"LEVEL "+t,level:t});this.createMenu(this.menu,this.setupMenuEvents.bind(this)),this.add.image(this.config.width/2,this.config.height/3,"logo").setScale(.6)}setupMenuEvents(e){const t=e.textGO;t.setInteractive(),t.on("pointerover",(()=>{t.setStyle({fill:"#a1ffa5"})})),t.on("pointerout",(()=>{t.setStyle({fill:"#ffffff"})})),t.on("pointerup",(()=>{e.scene&&(this.registry.set("level",e.level),this.scene.start(e.scene)),"Exit"===e.text&&this.game.destroy(!0)}))}}t.a=a},function(e,t,s){"use strict";var i=s(3);class a extends i.a{constructor(e){super("CreditsScene",{...e,canGoBack:!0}),this.menu=[{scene:null,text:"Thank     you     for     playing     this     demo".toUpperCase()},{scene:null,text:"Made     with     Tons     of     fun".toUpperCase()},{scene:null,text:"by     Giorgio     Perri".toUpperCase()}]}create(){super.create(),this.createMenu(this.menu,(()=>{})),this.add.image(this.config.width/2,this.config.height/3,"logo").setScale(.6)}}t.a=a},function(e,t,s){"use strict";var i=s(0),a=s.n(i);s(21);var r=class{constructor(e,t,s,i=1,a){this.bar=new Phaser.GameObjects.Graphics(e),this.x=t/i,this.y=s/i,this.health=a,this.scaleFactor=i,this.size={width:40,height:8},this.pixelPerHealth=this.size.width/this.health,e.add.existing(this.bar),this.draw(this.x,this.y,this.scaleFactor)}decrease(e){this.health=e<=0?0:e,this.draw(this.x,this.y,this.scaleFactor)}draw(e,t,s){this.bar.clear();const{width:i,height:a}=this.size;this.bar.fillStyle(0),this.bar.fillRect(e,t,i+2,a+2),this.bar.fillStyle(16777215),this.bar.fillRect(e+2,t+2,i-2,a-2);const r=Math.floor(this.health*this.pixelPerHealth);return this.bar.fillStyle((this.size.width,10616741)),r>0&&this.bar.fillRect(e+2,t+2,r-2,a-2),this.bar.setDepth(10),this.bar.setScrollFactor(0,0).setScale(s)}};class n extends Phaser.Physics.Arcade.Sprite{constructor(e,t,s,i,a){super(e,t,s),e.add.existing(this),e.physics.add.existing(this),this.target=null,this.effectName=i,this.impactPosition=a,this.on("animationcomplete",(e=>{e.key===this.effectName&&this.destroy()}),this)}preUpdate(e,t){super.preUpdate(e,t),this.placeEffect()}placeEffect(){if(!this.target)return;const e=this.target.getCenter();this.body&&this.body.reset(e.x,this.impactPosition.y)}playOn(e){this.target=e,this.play(this.effectName,!0),this.placeEffect()}}class h{constructor(e){this.scene=e}playEffectOn(e,t,s){new n(this.scene,0,0,e,s).playOn(t)}}class l extends Phaser.Physics.Arcade.Sprite{constructor(e,t,s,i){super(e,t,s,i),e.physics.add.existing(this),e.add.existing(this),this.speed=300,this.maxDistance=300,this.traveledDistance=0,this.cooldown=500,this.damage=10,this.bodySize=13,this.setSize(this.bodySize,this.bodySize),this.effectManager=new h(this.scene)}preUpdate(e,t){super.preUpdate(e,t),this.traveledDistance+=this.body.deltaAbsX(),this.isOutOfRange()&&(this.body.reset(0,0),this.isActive(!1),this.traveledDistance=0)}fire(e,t,s){this.isActive(!0),this.body.reset(e,t),this.setVelocityX(this.speed),s&&this.play(s,!0)}deliversHit(e){this.isActive(!1),this.traveledDistance=0;const t={x:this.x,y:this.y};this.body.reset(0,0),this.effectManager.playEffectOn("hitEffect",e,t)}isActive(e){this.setVisible(e),this.setActive(e)}isOutOfRange(){return this.traveledDistance&&this.traveledDistance>=this.maxDistance}}const o=()=>(new Date).getTime();s(12);class c extends Phaser.Physics.Arcade.Group{constructor(e,t){super(e.physics.world,e),this.createMultiple({frameQuantity:5,active:!1,visible:!1,key:t,classType:l}),this.timeFromLastProjectile=null}fireProjectile(e,t){const s=this.getFirstDead(!1);if(!s)return;if(this.timeFromLastProjectile&&this.timeFromLastProjectile+s.cooldown>o())return;const i=e.getCenter();let a;"Player"===e.name&&(s.setOffset(0),s.setScale(1.7)),e.lastDirection===Phaser.Physics.Arcade.FACING_RIGHT?(s.speed=Math.abs(s.speed),s.setFlipX(!1),a=20):(s.speed=-Math.abs(s.speed),s.setFlipX(!0),a=-20),s.fire(i.x+a,i.y,t),this.timeFromLastProjectile=o()}}class d extends Phaser.Physics.Arcade.Sprite{constructor(e,t,s,i){super(e,t,s,i),e.add.existing(this),e.physics.add.existing(this),this.damage=15,this.attackSpeed=400,this.weaponName=i,this.weaponAnim=i+"Swing",this.wielder=null,this.setScale(1.4),this.effectManager=new h(this.scene),this.setOrigin(.5,1),this.setDepth(10),this.activateWeapon(!1),this.on("animationcomplete",(e=>{e.key===this.weaponAnim&&(this.activateWeapon(!1),this.body.checkCollision.none=!1,this.body.reset(0,0))}))}preUpdate(e,t){super.preUpdate(e,t),this.active&&(this.setFlipX(this.wielder.lastDirection!==Phaser.Physics.Arcade.FACING_RIGHT),this.body.reset(this.wielder.x+(this.wielder.lastDirection===Phaser.Physics.Arcade.FACING_RIGHT?25:10),this.wielder.y),"Gunner"===this.wielder.name&&this.body.reset(this.wielder.x+(this.wielder.lastDirection===Phaser.Physics.Arcade.FACING_RIGHT?60:-60),this.wielder.y))}swing(e){this.wielder=e,this.activateWeapon(!0),this.anims.play(this.weaponAnim,!0)}deliversHit(e){const t={x:this.x,y:this.getRightCenter().y};this.effectManager.playEffectOn("hitEffect",e,t),this.body.checkCollision.none=!0}activateWeapon(e){this.setActive(e),this.setVisible(e)}}var p={isPlayingAnimation(e){return this.anims.isPlaying&&this.anims.getName()===e}},u={addCollider(e,t,s){return this.scene.physics.add.collider(this,e,t,null,s||this),this},addOverlap(e,t,s){return this.scene.physics.add.overlap(this,e,t,null,s||this),this},bodyPositionDifferenceX:0,prevRay:null,prevHasHit:null,raycast(e,t,{raylength:s=40,precision:i=0,steepness:a=1}){const{x:r,y:n,width:h,halfHeight:l}=e;if(this.bodyPositionDifferenceX+=e.x-e.prev.x,Math.abs(this.bodyPositionDifferenceX)<=i&&null!==this.prevHasHit)return{ray:this.prevRay,hasHit:this.prevHasHit};const o=new Phaser.Geom.Line;let c=!1;e.velocity.x>0?(o.x1=r+h,o.y1=n+l,o.x2=o.x1,o.y2=o.y1+s):(o.x1=r,o.y1=n+l,o.x2=o.x1,o.y2=o.y1+s);const d=t.getTilesWithinShape(o);return d.length>0&&(c=this.prevHasHit=d.some((e=>-1!==e.index))),this.prevRay=o,this.bodyPositionDifferenceX=0,{ray:o,hasHit:c}}};class y extends Phaser.Events.EventEmitter{constructor(){super()}}var g=new y;class m extends a.a.Physics.Arcade.Sprite{constructor(e,t,s){super(e,t,s,"player"),e.add.existing(this),e.physics.add.existing(this),Object.assign(this,u),Object.assign(this,p),this.init(),this.initEvents()}init(){this.gravity=500,this.playerSpeed=150,this.jumpCount=0,this.consecutiveJumps=1,this.name="Player",this.isSliding=!1,this.hasBeenHit=!1,this.bounceVelocity=200,this.cursors=this.scene.input.keyboard.createCursorKeys(),this.jumpSound=this.scene.sound.add("jump",{volume:3}),this.projectileSound=this.scene.sound.add("projectile-launch",{volume:1}),this.stepSound=this.scene.sound.add("step",{volume:.25,rate:2}),this.swipeSound=this.scene.sound.add("swipe",{volume:.3,rate:2.5}),this.projectiles=new c(this.scene,"iceball"),this.meleeWeapon=new d(this.scene,0,0,"swordDefault"),this.timeFromLastAttack=null,this.lastDirection=a.a.Physics.Arcade.FACING_RIGHT,this.health=50,this.hp=new r(this.scene,this.scene.config.leftTopCorner.x+5,this.scene.config.leftTopCorner.y+5,1.5,this.health),this.body.setGravityY(this.gravity),this.setScale(1.4),this.setOrigin(0,1),this.setSize(this.width-15,this.height-10),this.setOffset(5,8),this.setCollideWorldBounds(!0),(e=>{e.create({key:"idle",frames:e.generateFrameNumbers("nhuIdle",{start:0,end:4}),frameRate:8,repeat:-1}),e.create({key:"run",frames:e.generateFrameNumbers("nhuWalk",{start:0,end:6}),frameRate:8,repeat:-1}),e.create({key:"jump",frames:e.generateFrameNumbers("nhuJump",{start:0,end:3}),frameRate:8,repeat:1}),e.create({key:"throw",frames:e.generateFrameNumbers("nhuThrow",{start:0,end:2}),frameRate:8,repeat:0}),e.create({key:"slide",frames:e.generateFrameNumbers("playerSlide",{start:0,end:2}),frameRate:20,repeat:0})})(this.scene.anims),this.handleAttacks(),this.scene.time.addEvent({delay:450,repeat:-1,callbackScope:this,callback:()=>{this.isPlayingAnimation("run")&&this.stepSound.play()}})}initEvents(){this.scene.events.on(a.a.Scenes.Events.UPDATE,this.update,this)}update(){if(this.hasBeenHit||this.isSliding||!this.body)return;if(this.getBounds().top>this.scene.config.height)return void g.emit("PLAYER_LOST");const{left:e,right:t,space:s}=this.cursors,i=this.scene.input.keyboard.addKey("A"),r=this.scene.input.keyboard.addKey("D"),n=this.scene.input.keyboard.addKey("W"),h=a.a.Input.Keyboard.JustDown(s),l=a.a.Input.Keyboard.JustDown(n),o=this.body.onFloor();e.isDown||i.isDown?(this.lastDirection=a.a.Physics.Arcade.FACING_LEFT,this.setVelocityX(-this.playerSpeed),this.setFlipX(!0)):t.isDown||r.isDown?(this.lastDirection=a.a.Physics.Arcade.FACING_RIGHT,this.setVelocityX(this.playerSpeed),this.setFlipX(!1)):this.setVelocityX(0),(h||l)&&(o||this.jumpCount<this.consecutiveJumps)&&(this.jumpSound.play(),this.setVelocityY(2*-this.playerSpeed),this.jumpCount++),o&&(this.jumpCount=0),this.isPlayingAnimation("throw")||this.isPlayingAnimation("slide")||this.play(o?0!==this.body.velocity.x?"run":"idle":"jump",!0)}handleAttacks(){this.scene.input.keyboard.on("keydown-Q",(()=>{this.projectiles.fireProjectile(this,"greenProjectile"),this.play("throw",!0),this.projectileSound.play()})),this.scene.input.keyboard.on("keydown-E",(()=>{this.timeFromLastAttack&&this.timeFromLastAttack+this.meleeWeapon.attackSpeed>o()||(this.swipeSound.play(),this.play("throw",!0),this.meleeWeapon.swing(this),this.timeFromLastAttack=o())}))}playDamageTween(){return this.scene.tweens.add({targets:this,duration:100,repeat:-1,tint:16777215})}bounceOff(e){e.wielder&&"Gunner"===e.wielder.name?e.body&&(e.wielder.x>this.x?this.setVelocityX(-this.bounceVelocity):this.setVelocityX(this.bounceVelocity)):(e.body?this.body.touching.right?this.setVelocityX(-this.bounceVelocity):this.setVelocityX(this.bounceVelocity):this.body.blocked.right?this.setVelocityX(-this.bounceVelocity):this.setVelocityX(this.bounceVelocity),setTimeout((()=>this.setVelocityY(-this.bounceVelocity)),0))}takesHit(e){if(this.hasBeenHit)return;if(this.health-=e.damage||e.properties.damage||0,this.health<=0)return g.emit("PLAYER_LOST"),void(this.hasBeenHit=!1);this.hp.decrease(this.health),e.deliversHit&&e.deliversHit(this),this.hasBeenHit=!0,this.bounceOff(e);const t=this.playDamageTween();this.scene.time.delayedCall(800,(()=>{this.hasBeenHit=!1,t.stop(),this.clearTint()}))}}var f=m;class b extends a.a.Physics.Arcade.Sprite{constructor(e,t,s,i){super(e,t,s,i),this.config=e.config,e.add.existing(this),e.physics.add.existing(this),Object.assign(this,u),Object.assign(this,p),this.init(),this.initEvents()}init(){this.gravity=500,this.speed=50,this.timeFromLastTurn=0,this.maxPatrolDistance=1e3,this.currentPatrolDistance=0,this.colliders=null,this.rayGraphics=this.scene.add.graphics({lineStyle:{width:2,color:11141290}}),this.isShooting=!1,this.damage=20,this.health=20,this.body.setGravityY(this.gravity),this.setCollideWorldBounds(!0),this.setImmovable(!0),this.setOrigin(.5,1),this.setVelocityX(30)}initEvents(){this.scene.events.on(a.a.Scenes.Events.UPDATE,this.update,this)}update(e){if(this.getBounds().bottom>600)return this.scene.events.removeListener(a.a.Scenes.Events.UPDATE,this.update,this),this.rayGraphics.clear(),this.setActive(!1),void this.destroy();this.patrol(e)}patrol(e){if(!this.body||!this.body.onFloor())return;this.currentPatrolDistance+=Math.abs(this.body.deltaX());const{ray:t,hasHit:s}=this.raycast(this.body,this.colliders,{raylength:50,precision:1,steepness:.2});(!s||this.currentPatrolDistance>=this.maxPatrolDistance)&&this.timeFromLastTurn+100<e&&(this.setFlipX(!this.flipX),this.setVelocityX(this.speed=-this.speed),this.currentPatrolDistance=0,this.timeFromLastTurn=e),this.config.debug&&t&&(this.rayGraphics.clear(),this.rayGraphics.strokeLineShape(t))}setPlatformColliders(e){this.colliders=e}takesHit(e){e.deliversHit(this),this.health-=e.damage,this.health<=0&&this.die()}deliversHit(){}die(){this.setTint(16711680),this.setVelocity(0,-200),this.body.checkCollision.none=!0,this.setCollideWorldBounds(!1)}}var v=b;var w=class extends v{constructor(e,t,s){super(e,t,s,"birdman"),(e=>{e.create({key:"birdman-walk",frames:e.generateFrameNumbers("birdman",{start:0,end:3}),frameRate:4,repeat:-1})})(e.anims)}init(){super.init(),this.setScale(1.4)}update(e,t){super.update(e,t),this.active&&(this.isPlayingAnimation("birdman-damaged")||this.play("birdman-walk",!0))}takesHit(e){super.takesHit(e),this.setTintFill(16777215),this.scene.time.delayedCall(100,(()=>{this.clearTint(),this.health<=0&&this.setTint(16711680)}))}};const S={Birdman:w,Gunner:class extends v{constructor(e,t,s){super(e,t,s,"gunner"),(e=>{e.create({key:"gunner-walk",frames:e.generateFrameNumbers("gunner",{start:0,end:3}),frameRate:8,repeat:-1})})(e.anims)}init(){super.init(),this.speed=50,this.health=50,this.name="Gunner",this.projectiles=new c(this.scene,"fireball-1"),this.timeFromLastAttack=0,this.attackDelay=this.getAttackDelay(),this.lastDirection=null,this.meleeWeapon=new d(this.scene,0,0,"blaster"),this.setScale(1.4)}update(e,t){super.update(e,t),this.active&&(this.body.velocity.x>0?this.lastDirection=Phaser.Physics.Arcade.FACING_RIGHT:this.body.velocity.x<0&&(this.lastDirection=Phaser.Physics.Arcade.FACING_LEFT),this.timeFromLastAttack+this.attackDelay<=e&&(this.timeFromLastAttack=e,this.attackDelay=this.getAttackDelay(),this.meleeWeapon.swing(this)),this.active&&(this.isPlayingAnimation("gunner-shoot")?this.setOffset(50,0):(this.setOffset(0,0),this.play("gunner-walk",!0))))}getAttackDelay(){return Phaser.Math.Between(1e3,4e3)}takesHit(e){super.takesHit(e)}}};class P extends a.a.GameObjects.Group{constructor(e){super(e),Object.assign(this,u)}getProjectiles(){const e=new a.a.GameObjects.Group;return this.getChildren().forEach((t=>{t.projectiles&&e.addMultiple(t.projectiles.getChildren())})),e}getMeleeWeapons(){const e=new a.a.GameObjects.Group;return this.getChildren().forEach((t=>{t.meleeWeapon&&e.add(t.meleeWeapon)})),e}getTypes(){return S}}var x=P;class k extends Phaser.Physics.Arcade.Sprite{constructor(e,t,s,i){super(e,t,s,i),e.add.existing(this),this.score=1,this.setOrigin(0,1),e.tweens.add({targets:this,y:this.y-Phaser.Math.Between(3,6),duration:Phaser.Math.Between(1500,2500),repeat:-1,ease:"linear",yoyo:!0})}}class T extends Phaser.Physics.Arcade.StaticGroup{constructor(e){super(e.physics.world,e),this.createFromConfig({classType:k})}mapProperties(e){return e&&0!==e.length?e.reduce(((e,t)=>(e[t.name]=t.value,e)),{}):{}}addFromLayer(e){const{score:t,type:s}=this.mapProperties(e.properties);e.objects.forEach((e=>{const i=this.get(e.x,e.y,s),a=this.mapProperties(e.properties);i.score=a.score||t}))}}class C extends Phaser.Physics.Arcade.Sprite{constructor(e,t,s,i){super(e,t,s,i),e.add.existing(this),this.setOrigin(0,1).setScale(1.3),e.tweens.add({targets:this,y:this.y-Phaser.Math.Between(3,6),duration:Phaser.Math.Between(1500,2500),repeat:-1,ease:"linear",yoyo:!0})}}class O extends Phaser.Physics.Arcade.StaticGroup{constructor(e){super(e.physics.world,e),this.createFromConfig({classType:C})}mapProperties(e){return e&&0!==e.length?e.reduce(((e,t)=>(e[t.name]=t.value,e)),{}):{}}addFromLayer(e){const{type:t}=this.mapProperties(e.properties);e.objects.forEach((e=>{this.get(e.x,e.y,t)}))}}class F extends Phaser.GameObjects.Container{constructor(e,t,s){super(e,t,s),e.add.existing(this);const{rightTopCorner:i}=e.config;this.containerWidth=70,this.setPosition(i.x-this.containerWidth,i.y+15),this.setScrollFactor(0),this.setupList()}setupList(){const e=this.createScoreBoard();this.add(e)}createScoreBoard(){const e=this.scene.add.text(-17,-12,"0",{fontSize:"6px",fill:"#fff",fontFamily:"NHU"}).setStroke("#000000",5),t=this.scene.add.image(25,0,"battery").setOrigin(0,.3).setScale(1.5),s=this.scene.add.container(0,0,[e,t]);return s.setName("scoreBoard"),s}updateScoreBoard(e){const[t,s]=this.getByName("scoreBoard").list;t.setText(e)}}s(11);class L extends a.a.Scene{constructor(e){super("PlayScene"),this.config=e,this.layers=null,this.map=null,this.player=null}create({gameStatus:e}){this.score=0,this.hud=new F(this,0,0).setDepth(900),this.playBGMusic(),this.collectSound=this.sound.add("collectiblePickup",{volume:.2}),this.map=this.createMap(),(e=>{e.create({key:"hitEffect",frames:e.generateFrameNumbers("hitSheet",{start:0,end:4}),frameRate:10,repeat:0}),e.create({key:"swordDefaultSwing",frames:e.generateFrameNumbers("swordDefault",{start:0,end:2}),frameRate:10,repeat:0}),e.create({key:"blasterSwing",frames:e.generateFrameNumbers("blaster",{start:0,end:3}),frameRate:10,repeat:0}),e.create({key:"greenProjectile",frames:e.generateFrameNumbers("greenProjectile",{start:0,end:4}),frameRate:8,repeat:-1}),e.create({key:"fireball",frames:[{key:"fireball-1"},{key:"fireball-2"},{key:"fireball-3"}],frameRate:5,repeat:-1}),e.create({key:"iceball",frames:[{key:"iceball-1"},{key:"iceball-2"}],frameRate:5,repeat:-1}),e.create({key:"batterySpark",frames:e.generateFrameNumbers("battery",{start:0,end:4}),frameRate:8,repeat:-1})})(this.anims),this.layers=this.createLayers(this.map);const t=this.getPlayerZones(this.layers.playerZones);this.player=this.createPlayer(t.start);const s=this.createEnemies(this.layers.enemySpawns,this.layers.colliders),i=this.createCollectables(this.layers.collectibles),a=null!=this.layers.key?this.createKey(this.layers.key):null;this.createTutorialTexts(),this.createBG(),this.createEnemyColliders(s,{colliders:{platformsColliders:this.layers.colliders,player:this.player}}),this.createPlayerColliders(this.player,{colliders:{platformsColliders:this.layers.colliders,obstacleCollider:this.layers.obstacleCollider,projectiles:s.getProjectiles(),collectibles:i,key:a,traps:this.layers.traps,meleeWeapons:s.getMeleeWeapons()}}),this.createBackButton(),this.createEndOfLevel(t.end,this.player),this.setupFollowupCameraOn(this.player),"PLAYER_LOST"!==e&&this.createGameEvents()}playBGMusic(){this.sound.get("theme")||this.sound.add("theme",{loop:!0,volume:1}).play()}createMap(){const e=this.make.tilemap({key:"level-"+this.getCurrentLevel()});return e.addTilesetImage("nhu_tileset","tiles-1",16,16),e}createLayers(e){const t=e.getTileset("nhu_tileset"),s=e.createLayer("Bg_Ropes",t),i=e.createLayer("Traps",t),a=e.createLayer("Bg_Pipes",t),r=e.createLayer("Bg_Plants",t),n=e.createLayer("Bg_Doors",t),h=e.createLayer("Doors",t),l=e.createLayer("Colliders",t),o=e.getObjectLayer("PlayerZones"),c=e.getObjectLayer("EnemySpawnPoints"),d=e.createLayer("Platforms",t),p=e.getObjectLayer("Collectibles"),u=e.createLayer("TutorialTiles",t)||null,y=e.createLayer("ObstacleSprite",t)||null,g=e.createLayer("ObstacleCollider",t)||null,m=e.getObjectLayer("Key")||null;return l.setCollisionByProperty({collides:!0}),g&&g.setCollisionByProperty({collides:!0},!0),i.setCollisionByExclusion(-1),{ropes:s,pipes:a,plants:r,doorBackgrounds:n,doors:h,colliders:l,playerZones:o,enemySpawns:c,platforms:d,traps:i,collectibles:p,obstacleCollider:g,obstacleSprite:y,key:m,tutorialTiles:u}}createBG(){this.bg0=this.add.tileSprite(0,0,this.config.width,this.config.height,"gameplay-bg-0").setDepth(-30).setOrigin(0).setScale(1.5).setScrollFactor(0,1),this.bg1=this.add.tileSprite(0,0,this.config.width,this.config.height,"gameplay-bg-1").setDepth(-29).setOrigin(0,0).setScale(1.8).setScrollFactor(0,1),this.bg2=this.add.tileSprite(0,0,this.config.width,this.config.height,"gameplay-bg-2").setDepth(-28).setOrigin(0,0).setScale(1.8).setScrollFactor(0,1),this.bg3=this.add.tileSprite(0,0,this.config.width,this.config.height,"gameplay-bg-3").setDepth(-27).setOrigin(0,0).setScale(1.8).setScrollFactor(0,1)}createGameEvents(){g.on("PLAYER_LOST",(()=>{this.scene.restart({gameStatus:"PLAYER_LOST"})}))}createCollectables(e){const t=new T(this).setDepth(3);return t.addFromLayer(e),t.playAnimation("batterySpark"),t.rotate(.5),t}createKey(e){const t=new O(this).setDepth(3);return t.addFromLayer(e),t}createTutorialTexts(){1==this.getCurrentLevel()&&(this.add.image(137,480,"moveText").setScale(.05).setDepth(-1),this.add.image(328,450,"jumpText").setScale(.05).setDepth(-1),this.add.image(752,510,"doubleJumpText").setScale(.05).setDepth(3),this.add.image(800,551,"twiceText").setScale(.04).setDepth(3),this.add.image(955,584,"slashText").setScale(.05).setDepth(3),this.add.image(1245,584,"shootText").setScale(.05).setDepth(3))}createForegroundDressing(e){const t=e.getTileset("main_lev_build_1");e.createLayer("Dressing",t)}createPlayer(e){return new f(this,e.x,e.y)}createEnemies(e,t){const s=new x(this),i=s.getTypes();return e.objects.forEach((e=>{const a=new i[e.type](this,e.x,e.y);a.setPlatformColliders(t),s.add(a)})),s}onPlayerCollision(e,t){t.takesHit(e)}onHit(e,t){e.takesHit(t)}onCollect(e,t){this.score+=t.score,this.hud.updateScoreBoard(this.score),t.disableBody(!0,!0),this.collectSound.play()}onKeyPickedUp(e,t){t.disableBody(!0,!0),this.map.getLayer("ObstacleCollider").tilemapLayer.setCollisionByProperty({collides:!0},!1),this.map.getLayer("ObstacleSprite").tilemapLayer.destroy()}createEnemyColliders(e,{colliders:t}){e.addCollider(t.platformsColliders).addCollider(t.player,this.onPlayerCollision).addCollider(t.player.projectiles,this.onHit).addOverlap(t.player.meleeWeapon,this.onHit)}createPlayerColliders(e,{colliders:t}){e.addCollider(t.platformsColliders).addCollider(t.obstacleCollider).addCollider(t.projectiles,this.onHit).addOverlap(t.collectibles,this.onCollect,this).addOverlap(t.key,this.onKeyPickedUp,this).addCollider(t.traps,this.onHit).addOverlap(t.meleeWeapons,this.onHit)}setupFollowupCameraOn(e){const{height:t,width:s,mapOffset:i,zoomFactor:a}=this.config;this.physics.world.setBounds(0,0,s+i,t+200),this.cameras.main.setBounds(0,0,s+i,t).setZoom(a),this.cameras.main.startFollow(e)}getPlayerZones(e){const t=e.objects;return{start:t.find((e=>"StartZone"===e.name)),end:t.find((e=>"EndZone"===e.name))}}getCurrentLevel(){return this.registry.get("level")||1}createBackButton(){this.add.image(this.config.rightBottomCorner.x,this.config.rightBottomCorner.y,"back").setOrigin(1).setDepth(900).setScrollFactor(0).setScale(1.5).setInteractive().on("pointerup",(()=>{this.scene.start("MenuScene")}))}createEndOfLevel(e,t){const s=this.physics.add.sprite(e.x,e.y,"end").setAlpha(0).setSize(5,25).setOrigin(.5,1),i=this.physics.add.overlap(t,s,(()=>{i.active=!1,this.registry.get("level")!==this.config.lastLevel?(this.registry.inc("level",1),this.registry.inc("unlocked-levels",1),this.scene.restart({gameStatus:"LEVEL_COMPLETED"})):this.scene.start("CreditsScene")}))}update(){this.bg1.tilePositionX=.05*this.cameras.main.scrollX,this.bg2.tilePositionX=.2*this.cameras.main.scrollX,this.bg3.tilePositionX=.3*this.cameras.main.scrollX}}t.a=L},function(e,t,s){"use strict";s.r(t),function(e){var t=s(0),i=s.n(t),a=s(19),r=s(15),n=s(16),h=s(17),l=s(18);const o=document.body.offsetWidth,c=600,d=1.325,p={mapOffset:1600>o?1600-o:0,width:o,height:c,zoomFactor:d,debug:!1,leftTopCorner:{x:(o-o/d)/2,y:73.58490566037736},rightTopCorner:{x:o/d+(o-o/d)/2,y:73.58490566037736},rightBottomCorner:{x:o/d+(o-o/d)/2,y:526.4150943396227},lastLevel:4},u=[r.a,n.a,h.a,a.a,l.a],y=e=>new e(p),g={type:i.a.CANVAS,...p,pixelArt:!0,antialias:!0,physics:{default:"arcade",arcade:{debug:p.debug}},scene:u.map(y),parent:"Body"};e.env.FB_ENV,FBInstant.initializeAsync().then((()=>{new i.a.Game(g)}))}.call(this,s(7))}]);